(this.webpackJsonpaviasales=this.webpackJsonpaviasales||[]).push([[0],[,,,,,,,,,,,function(e,t,n){e.exports=n.p+"static/media/logo_aviasales.0c089234.svg"},,,function(e,t,n){e.exports=n(25)},,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},,function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var r=n(4),a=n(5),s=n(8),c=n(7),i=n(0),u=n.n(i),o=n(10),l=n.n(o);n(19),n(20);function f(){return u.a.createElement(u.a.Fragment,null,u.a.createElement("p",{className:"timeout__tip"},"\u041e\u0436\u0438\u0434\u0430\u043d\u0438\u0435 \u0432\u0432\u043e\u0434\u0430..."),u.a.createElement("div",{className:"timeout"}))}var m=n(11),p=n.n(m);function d(){return u.a.createElement("div",{className:"logo center"},u.a.createElement("img",{src:p.a,alt:"Aviasales logo",style:{width:"82px"}}))}var h=n(13);n(21);function v(e){return u.a.createElement("form",{className:"form filter"},u.a.createElement("h3",{className:"form__header"},"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043e\u043a"),function(e,t){return Object.entries(e.filters).sort((function(e){return-("all"===e[0])})).map((function(n,r){var a=Object(h.a)(n,2),s=a[0],c=a[1];return u.a.createElement("div",{className:"filter__item",key:r},u.a.createElement("input",{className:"filter__input",type:"checkbox",id:s,checked:c,onChange:function(t){return function(e,t){t.onChange(e)}(t,e)}}),u.a.createElement("label",{className:"filter__label",htmlFor:s},t[s]))}))}(e,{all:"\u0412\u0441\u0435",0:"\u0411\u0435\u0437 \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043e\u043a",1:"1 \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043a\u0430",2:"2 \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043a\u0438",3:"3 \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043a\u0438"}))}function g(e){return u.a.createElement("div",{className:"card row__col-side"},u.a.createElement(v,{filters:e.filters,onChange:e.onChange}))}var b=n(12),k=n(1),E=n.n(k),_=n(2);n(23);function y(e){return u.a.createElement("ul",{className:"tabs card",onClick:function(t){return function(e,t){t.onClick(e)}(t,e)}},u.a.createElement("li",{"data-sorter":"cheapest",className:"tabs__item tabs__item_active"},"\u0421\u0430\u043c\u044b\u0439 \u0434\u0435\u0448\u0435\u0432\u044b\u0439"),u.a.createElement("li",{"data-sorter":"fastest",className:"tabs__item"},"\u0421\u0430\u043c\u044b\u0439 \u0431\u044b\u0441\u0442\u0440\u044b\u0439"))}n(24);function w(e){return u.a.createElement("div",{className:"flight__block"},u.a.createElement("span",{className:"text-grey"},"".concat(e.segment.origin," - ").concat(e.segment.destination)),u.a.createElement("span",{className:"fw-bold"},function(e,t){var n=new Date(e),r=new Date(Date.parse(e)+60*t*1e3),a=n.getHours()<10?"0"+n.getHours():n.getHours(),s=n.getMinutes()<10?"0"+n.getMinutes():n.getMinutes(),c=r.getHours()<10?"0"+r.getHours():r.getHours(),i=r.getMinutes()<10?"0"+r.getMinutes():r.getMinutes();return"".concat(a,":").concat(s," - ").concat(c,":").concat(i)}(e.segment.date,e.segment.duration)))}function N(e){return u.a.createElement("div",{className:"flight__block"},u.a.createElement("span",{className:"text-grey"},function(e){switch(e.length){case 1:return"1 \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043a\u0430";case 2:return"2 \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043a\u0438";case 3:return"3 \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043a\u0438";default:return"\u0411\u0435\u0437 \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043e\u043a"}}(e.stops)),u.a.createElement("span",{className:"fw-bold"},e.stops.map((function(e,t){return t>0?", "+e:e}))))}function x(e){return u.a.createElement("div",{className:"flight__block"},u.a.createElement("span",{className:"text-grey"},"\u0412 \u043f\u0443\u0442\u0438"),u.a.createElement("span",{className:"fw-bold"},function(e){var t=parseInt(e/60),n=Math.round(60*(e/60-t));return"".concat(t,"\u0447 ").concat(n,"\u043c")}(e.duration)))}function j(e){return e.details.map((function(e,t){return u.a.createElement("div",{key:t,className:"flight row"},u.a.createElement(w,{segment:e}),u.a.createElement(x,{duration:e.duration}),u.a.createElement(N,{stops:e.stops}))}))}function O(e){return u.a.createElement("div",{className:"card ticket"},u.a.createElement("div",{className:"row row_btwn"},u.a.createElement("span",{className:"price"},e.ticketInfo.price," \u0420"),u.a.createElement("div",{className:"logo-iata"},u.a.createElement("img",{src:"http://pics.avs.io/99/36/".concat(e.ticketInfo.carrier,".png"),alt:e.ticketInfo.carrier}))),u.a.createElement(j,{details:e.ticketInfo.segments}))}function L(e){return e.ticketsArray?u.a.createElement("div",{className:"tickets"},e.ticketsArray.map((function(e,t){return u.a.createElement(O,{ticketInfo:e,key:t})}))):u.a.createElement("p",{className:"row"},"\u041f\u043e\u0434\u043e\u0436\u0434\u0438\u0442\u0435, \u0437\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u043c \u043d\u043e\u0432\u044b\u0435 \u0431\u0438\u043b\u0435\u0442\u044b")}var C=function(e){Object(s.a)(n,e);var t=Object(c.a)(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={tickets:null},a}return Object(a.a)(n,[{key:"render",value:function(){return u.a.createElement("div",{className:"main row__col-main"},u.a.createElement(y,{onClick:this.props.onClick}),u.a.createElement(L,{ticketsArray:this.state.tickets}))}},{key:"componentDidMount",value:function(){var e=Object(_.a)(E.a.mark((function e(){var t;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getTickets();case 2:t=e.sent,this.setState({tickets:t});case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(_.a)(E.a.mark((function e(t){var n;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t===this.props){e.next=6;break}return this.setState({tickets:null}),e.next=4,this.getTickets();case 4:n=e.sent,this.setState({tickets:n});case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getTickets",value:function(){var e=Object(_.a)(E.a.mark((function e(){var t,n,r,a,s,c,i,u=arguments;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=u.length>0&&void 0!==u[0]?u[0]:this.props.sort,n=u.length>1&&void 0!==u[1]?u[1]:this.props.filters,r=new URL("https://front-test.beta.aviasales.ru"),a=new URL("/search",r),s=new URL("/tickets?searchId=",r),e.next=7,S(a);case 7:return c=e.sent,console.group("\u043f\u043e\u043b\u0443\u0447\u0430\u0435\u043c \u043d\u043e\u0432\u044b\u0435 \u0431\u0438\u043b\u0435\u0442\u044b..."),console.log("searchID: "+c+", URL:",s+c),e.next=12,M(s+c);case 12:return i=q(i=e.sent,n),i=("cheapest"===t?A:U)(i),console.groupEnd(),e.abrupt("return",i.slice(0,5));case 17:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(i.Component);function S(e){return I.apply(this,arguments)}function I(){return(I=Object(_.a)(E.a.mark((function e(t){var n,r;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:return n=e.sent,e.next=5,n.json();case 5:return r=e.sent,e.abrupt("return",r.searchId);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function M(e){return T.apply(this,arguments)}function T(){return(T=Object(_.a)(E.a.mark((function e(t){var n,r,a,s;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=[],r=!1,a=0;case 2:if(!(!0!==r&&a<100)){e.next=13;break}return a>=90&&console.warn("\u043f\u0440\u0435\u0432\u044b\u0448\u0435\u043d\u0438\u0435 \u043a\u043e\u043b-\u0432\u0430 \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432, \u043e\u0441\u0442\u0430\u043b\u043e\u0441\u044c",100-a),e.next=6,D(t);case 6:s=e.sent,r=s.stop,n.push.apply(n,Object(b.a)(s.tickets)),r&&console.log("\u043f\u043e\u0438\u0441\u043a \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d! stop:",s.stop,", count of tickets:",n.length);case 10:a+=1,e.next=2;break;case 13:return e.abrupt("return",n);case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function D(e){return H.apply(this,arguments)}function H(){return(H=Object(_.a)(E.a.mark((function e(t){var n;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:if(500!==(n=e.sent).status){e.next=7;break}return e.next=6,D(t);case 6:return e.abrupt("return",e.sent);case 7:return e.next=9,n.json();case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function q(e,t){if(t.all)return e;var n=Object.entries(t).filter((function(e){return e[1]})).map((function(e){return+e[0]}));return e.filter((function(e){return n.includes(function(e){return Math.max(e.segments[0].stops.length,e.segments[1].stops.length)}(e))}))}function A(e){return e.slice().sort((function(e,t){return e.price-t.price}))}function U(e){return e.slice().sort((function(e,t){return e.segments.reduce((function(e,t){return e.duration+t.duration}))-t.segments.reduce((function(e,t){return e.duration+t.duration}))}))}var R=function(e){Object(s.a)(n,e);var t=Object(c.a)(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e))._timeoutBeforeSearch=2e3,a.state={sort:"cheapest",filters:{all:!0,0:!1,1:!1,2:!1,3:!1}},a}return Object(a.a)(n,[{key:"render",value:function(){var e=B(this,this._timeoutBeforeSearch);return u.a.createElement("div",{className:"container"},u.a.createElement(f,null),u.a.createElement("div",{className:"row"},u.a.createElement(d,null)),u.a.createElement("div",{className:"row"},u.a.createElement(g,{filters:this.state.filters,onChange:e}),u.a.createElement(C,{onClick:e,filters:this.state.filters,sort:this.state.sort})))}},{key:"getValidCheckboxes",value:function(e){var t=this.state.filters,n=e.target.id;if(t[n]&&Object.entries(t).filter((function(e){return e[0]!==n})).every((function(e){return!e[1]})))return t;if(t.all&&!t[n]&&"all"!==n){var r=Object.assign({},this.state);return r.filters.all=!1,r.filters[n]=!r.filters[n],r.filters}if("all"===n&&Object.values(t).some((function(e){return e}))){var a=Object.assign({},this.state);for(var s in a.filters)a.filters.hasOwnProperty(s)&&(a.filters[s]=!1);return a.filters.all=!0,a.filters}var c=Object.assign({},this.state);return c.filters[n]=!c.filters[n],c.filters}}]),n}(i.Component),B=function(e,t){var n=Object.assign({},e.state),r=J(t,null,F),a=new Set,s=J(t,V,P),c=J(t,z,G);return function(t){t.currentTarget.classList.contains("tabs")?(n.sort=t.target.dataset.sorter,function(e){var t="tabs__item_active";if(e.target.classList.contains(t))return;e.currentTarget.querySelector("."+t).classList.remove(t),e.target.classList.add(t)}(t)):n.filters=e.getValidCheckboxes(t),c(),s(a,t),r(e,n)}};function F(e,t){e.setState((function(){return t}))}function J(e,t,n){var r;return function(){for(var a=arguments.length,s=new Array(a),c=0;c<a;c++)s[c]=arguments[c];clearTimeout(r),t&&t.apply(void 0,s),r=setTimeout((function(){n.apply(void 0,s),clearTimeout(r)}),e)}}function V(e,t){t.target.matches(".buffered")?(e.delete(t.target),t.target.classList.remove("buffered")):(e.add(t.target),t.target.classList.add("buffered"))}function P(e){e.forEach((function(e){return e.classList.remove("buffered")})),e.clear()}function z(){var e=document.querySelector(".timeout"),t=document.querySelector(".timeout__tip");t.className="timeout__tip",e.className="timeout",t.classList.add("timeout__tip_run"),e.classList.add("timeout_run")}function G(){var e=document.querySelector(".timeout");document.querySelector(".timeout__tip").classList.remove("timeout__tip_run"),e.classList.remove("timeout_run")}l.a.render(u.a.createElement(R,null),document.getElementById("root"))}],[[14,1,2]]]);
//# sourceMappingURL=main.871ffd6b.chunk.js.map